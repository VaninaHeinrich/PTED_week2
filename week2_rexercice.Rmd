Task 1 

```{r}
install.packages("tidyverse")
library(readr)        # to import tabular data (e.g. csv)
library(dplyr)        # to manipulate (tabular) data
library(ggplot2)      # to visualize data
library(sf)           # to handle spatial vector data
library(terra)        # To handle raster data
library(lubridate)    # To handle dates and times
```

```{r}
wildschwein_BE <- read_delim("wildschwein_BE_2056.csv",",")
```

```{r}
wildschwein_BE <- st_as_sf(wildschwein_BE, coords = c("E", "N"), crs = 2056, remove = FALSE)
wildschwein_BE

```

Task 2 : Getting an overview
Calculate the time difference between subsequent rows

```{r}
wildschwein <- mutate(wildschwein_BE,timelag = as.numeric(difftime(lead(DatetimeUTC),DatetimeUTC)), units = "sec")
wildschwein
```


```{r}
wildschwein %>% group_by(TierID) %>% summarise(mean_timelag = mean(timelag,na.rm = T))
```
Creating visualisation plot : 

```{r}
ggplot(data = wildschwein_BE) +geom_point(mapping = aes(x = DatetimeUTC, y = TierID), color = "blue")
```

    How many individuals were tracked?
    3

    For how long were the individual tracked? Are there gaps?
    002A : about 1 year
    016A : a little bit less than 8 months
    O18A : about 8 months
    
    Were all individuals tracked concurrently or sequentially?
    concurrently
    
    What is the temporal sampling interval between the locations?
    002A : 290 sec
    016A : 2.5 sec
    018A : 1600 sec


Task 3 : Deriving movement parameters I: Speed

```{r}
E2 <- lead(wildschwein_BE$E, 1)
N2 <- lead(wildschwein_BE$N, 1)
steplength <- sqrt((wildschwein_BE$E - E2)^2 + (wildschwein_BE$N - N2)^2)
wildschwein <- mutate(wildschwein_BE,timelag = as.numeric(difftime(lead(DatetimeUTC),DatetimeUTC)), units = "sec", steplength)
wildschwein

```

Animals'speed : 

the animal's speed is defined by the steplength by seconde

in theory : steplength/timelag = m/s

```{r}
speed <- wildschwein$steplength/wildschwein$timelag
wildschwein <- mutate(wildschwein_BE,timelag = as.numeric(difftime(lead(DatetimeUTC),DatetimeUTC)), units = "sec", steplength, speed)
wildschwein
```

we want to now the mean speed per animal 

```{r}
wildschwein %>% group_by(TierID) %>% summarise(mean_speed = mean(speed,na.rm = T))
```


